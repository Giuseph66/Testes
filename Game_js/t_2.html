<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Coleta de Dados Básicos com IP</title>
</head>
<body>
  <h1>Bem-vindo!</h1>
  <p>Esta página coleta dados básicos do seu dispositivo para análise.</p>
  <h2>IP do Dispositivo</h2>
  <p>Seu IP é: <span id="ip"></span></p>
  <h2>Dados Básicos do Dispositivo</h2>
  <p>Usuário do Navegador: <span id="userAgent"></span></p>
  <p>Enviado: <span id="foi"></span></p>
  <script>
    // Função para coletar dados básicos do dispositivo
    function coletarDadosBasicos() {
      return {
        userAgent: navigator.userAgent,
        linguagem: navigator.language,
        resolucaoTela: {
          largura: screen.width,
          altura: screen.height
        }
      };
    }
    
    // Função para enviar os dados para o servidor
    function enviarDados(dados) {
        document.getElementById('ip').textContent = dados.ip;
        document.getElementById('userAgent').textContent = dados.userAgent;
      fetch('https://82bf-168-90-211-194.ngrok-free.app/receber_dados', {  // Atualize para a URL do seu backend
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(dados)
      })
      .then(response => response.json())
      .then(result => {
        document.getElementById('foi').textContent = result.mensagem;
        console.log('Dados enviados com sucesso:', result);
    })
    .catch(error => {
          document.getElementById('foi').textContent = error;
        console.error('Erro ao enviar dados:', error);
      });
    }
    
    // Coleta os dados básicos
    const dados = coletarDadosBasicos();
    
    // Obtém o IP do usuário usando o serviço ipify
    fetch('https://api.ipify.org?format=json')
      .then(response => response.json())
      .then(data => {
        dados.ip = data.ip;
        enviarDados(dados);
      })
      .catch(error => {
        console.error("Erro ao obter IP:", error);
        dados.ip = "Nao suportado";
        enviarDados(dados);
      });
  </script>
</body>
</html>
